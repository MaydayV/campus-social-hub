# 📊 Excel 模板格式说明

本文档说明如何使用 Excel 批量管理新媒体平台数据。

## 📥 获取 Excel 模板

### 方法一：从管理后台导出（推荐）

1. 打开 `admin.html`
2. 点击【📤 导出 Excel】
3. 系统会自动下载包含当前数据的 Excel 文件
4. 可以直接在此基础上编辑

### 方法二：手动创建

按照下面的格式创建 Excel 文件，必须包含 3 个工作表。

---

## 📋 Excel 文件结构

Excel 文件必须包含以下 3 个工作表（Sheet），名称必须完全一致：

### Sheet 1: 平台配置

| 平台标识 | 平台名称 |
|---------|---------|
| wechat | 微信公众号 |
| weibo | 微博 |
| douyin | 抖音 |
| bilibili | B站 |
| xiaohongshu | 小红书 |

**说明：**
- `平台标识`: 只能包含字母、数字、下划线（如：`wechat`）
- `平台名称`: 显示在网站上的名称（如：`微信公众号`）

---

### Sheet 2: 分类配置

| 分类标识 | 分类名称 |
|---------|---------|
| xiaoji | 校级媒体 |
| ligong | 理工学院 |
| wenke | 文科学院 |
| shangke | 商科学院 |
| yixue | 医学院 |

**说明：**
- `分类标识`: 只能包含字母、数字、下划线（如：`xiaoji`）
- `分类名称`: 显示在网站上的名称（如：`校级媒体`）

---

### Sheet 3: 账号配置

| 平台标识 | 分类标识 | 账号名称 | 头像URL | 链接URL | 简介 |
|---------|---------|---------|---------|---------|------|
| wechat | xiaoji | 校团委 | https://picsum.photos/200?random=1 | https://example.com/youth | 发布校园活动、青年资讯 |
| wechat | xiaoji | 校学生会 | https://picsum.photos/200?random=2 | https://example.com/union | 服务同学、传递校园资讯 |
| wechat | ligong | 计算机学院 | https://picsum.photos/200?random=3 | https://example.com/cs | 发布学院动态、专业资讯 |
| weibo | xiaoji | 校团委 | https://picsum.photos/200?random=4 | https://weibo.com/... | 校园生活、青年风采 |
| douyin | wenke | 新闻学院 | https://picsum.photos/200?random=5 | https://douyin.com/... | 校园资讯、短视频创作 |

**说明：**
- `平台标识`: 必须是 Sheet 1 中已定义的平台标识
- `分类标识`: 必须是 Sheet 2 中已定义的分类标识
- `账号名称`: 必填，显示的账号名称
- `头像URL`: 必填，必须以 `http://` 或 `https://` 开头
- `链接URL`: 必填，必须以 `http://` 或 `https://` 开头
- `简介`: 可选，账号的描述信息

---

## ✅ 数据验证规则

### 标识符规则

- ✅ 只能包含：字母、数字、下划线
- ✅ 示例：`wechat`, `school_media`, `ligong_2024`
- ❌ 不能包含：中文、空格、特殊符号
- ❌ 错误示例：`校级`, `school media`, `school@media`

### URL 规则

- ✅ 必须是完整的 URL
- ✅ 必须以 `http://` 或 `https://` 开头
- ✅ 示例：`https://example.com/account`
- ❌ 错误示例：`example.com`, `www.example.com`

### 引用规则

- ✅ 账号配置中的平台标识必须在平台配置中存在
- ✅ 账号配置中的分类标识必须在分类配置中存在
- ❌ 不能使用未定义的平台或分类

---

## 🔧 编辑技巧

### 1. 批量添加账号

```
1. 复制已有行
2. 修改对应字段
3. 可快速添加多个账号
```

### 2. 使用查找替换

```
场景：批量修改图片链接域名
1. Ctrl+H 打开查找替换
2. 查找：old-domain.com
3. 替换：new-domain.com
4. 全部替换
```

### 3. 数据排序

```
1. 选中数据区域
2. 使用 Excel 的排序功能
3. 可按平台、分类排序，方便管理
```

---

## 📝 完整示例

### 示例：添加新平台"视频号"

**Step 1: 在 Sheet 1 添加平台**

| 平台标识 | 平台名称 |
|---------|---------|
| shipin | 视频号 |

**Step 2: 在 Sheet 3 添加账号**

| 平台标识 | 分类标识 | 账号名称 | 头像URL | 链接URL | 简介 |
|---------|---------|---------|---------|---------|------|
| shipin | xiaoji | 校团委视频号 | https://... | https://... | 记录校园精彩瞬间 |

### 示例：添加新分类"艺术学院"

**Step 1: 在 Sheet 2 添加分类**

| 分类标识 | 分类名称 |
|---------|---------|
| yishu | 艺术学院 |

**Step 2: 在 Sheet 3 添加账号**

| 平台标识 | 分类标识 | 账号名称 | 头像URL | 链接URL | 简介 |
|---------|---------|---------|---------|---------|------|
| wechat | yishu | 艺术学院 | https://... | https://... | 分享艺术作品 |

---

## ⚠️ 常见错误

### 错误 1: 工作表名称不正确
```
❌ 错误：Sheet 名称为 "平台" 
✅ 正确：Sheet 名称必须是 "平台配置"
```

### 错误 2: 标识符包含中文
```
❌ 错误：平台标识 = "微信"
✅ 正确：平台标识 = "wechat"
```

### 错误 3: URL 格式不正确
```
❌ 错误：链接 = "example.com"
✅ 正确：链接 = "https://example.com"
```

### 错误 4: 引用了不存在的标识
```
❌ 错误：账号的平台标识是 "tiktok"，但平台配置中没有定义
✅ 正确：先在平台配置中添加 "tiktok"，再使用
```

### 错误 5: 必填字段为空
```
❌ 错误：账号名称为空
✅ 正确：所有必填字段都要填写
```

---

## 📤 导入步骤

1. **保存 Excel 文件**
   - 确保保存为 `.xlsx` 或 `.xls` 格式
   - 文件名可以任意

2. **打开管理后台**
   - 打开 `admin.html`

3. **导入文件**
   - 点击【📥 导入 Excel】
   - 选择编辑好的 Excel 文件

4. **验证数据**
   - 系统会自动验证数据格式
   - 如有错误会提示具体问题

5. **生成配置**
   - 确认无误后，点击【💾 生成配置文件】
   - 下载并替换 `js/config.js`

---

## 💡 最佳实践

### 1. 数据备份
- 每次修改前先导出备份
- 保留多个历史版本

### 2. 分步操作
- 先添加平台和分类
- 再批量添加账号
- 避免引用错误

### 3. 数据检查
- 使用 Excel 的数据验证功能
- 检查是否有重复的标识
- 确保 URL 格式正确

### 4. 团队协作
- 使用统一的命名规范
- 约定好标识符格式
- 定期同步数据

---

## 🆘 需要帮助？

- 📖 查看 [管理后台使用指南](ADMIN_GUIDE.md)
- 📖 查看 [README.md](../README.md)
- 💬 联系技术支持

---

*最后更新：2025-10-15*

