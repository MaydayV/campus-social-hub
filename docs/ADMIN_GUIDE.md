# 📱 新媒体平台管理后台使用指南

欢迎使用新媒体平台管理后台！本指南将帮助您快速上手，轻松管理校园新媒体平台数据。

## 🎯 功能概述

管理后台提供以下核心功能：

✅ **平台管理** - 添加/编辑/删除社交媒体平台（如微信、微博、抖音等）  
✅ **分类管理** - 添加/编辑/删除学院分类（如校级媒体、理工学院等）  
✅ **账号管理** - 添加/编辑/删除各平台账号信息  
✅ **Excel 导入导出** - 批量编辑数据，支持 Excel/WPS  
✅ **一键生成配置** - 自动生成配置文件，无需手写代码  
✅ **数据验证** - 自动检查数据格式，避免错误  

---

## 🚀 快速开始

### 方式一：可视化编辑（推荐新手）

1. **打开管理后台**
   - 双击打开 `admin.html` 文件
   - 或在浏览器中输入：`http://localhost/admin.html`

2. **添加平台**（如果还没有）
   - 点击左侧【平台管理】
   - 点击【➕ 添加平台】
   - 填写平台信息（如：wechat / 微信公众号）
   - 点击【保存】

3. **添加分类**（如果还没有）
   - 点击左侧【分类管理】
   - 点击【➕ 添加分类】
   - 填写分类信息（如：xiaoji / 校级媒体）
   - 点击【保存】

4. **添加账号**
   - 点击左侧【账号管理】
   - 点击【➕ 添加账号】
   - 选择平台和分类
   - 填写账号信息
   - 点击【保存】

5. **生成配置文件**
   - 点击顶部【💾 生成配置文件】
   - 浏览器会自动下载 `config.js` 文件
   - 将下载的文件替换项目中的 `js/config.js`
   - 刷新网站即可看到更新

### 方式二：Excel 批量编辑（推荐批量操作）

1. **导出现有数据**
   - 点击顶部【📤 导出 Excel】
   - 下载 Excel 文件

2. **使用 Excel 编辑**
   - 用 Excel 或 WPS 打开文件
   - 文件包含 3 个工作表：
     - **Sheet 1 - 平台配置**：管理所有平台
     - **Sheet 2 - 分类配置**：管理所有分类
     - **Sheet 3 - 账号配置**：管理所有账号
   - 按照表格格式添加/修改数据

3. **导入更新后的数据**
   - 保存 Excel 文件
   - 点击【📥 导入 Excel】
   - 选择刚才编辑的 Excel 文件
   - 系统自动验证并更新数据

4. **生成配置文件**
   - 点击【💾 生成配置文件】
   - 替换项目中的 `js/config.js`

---

## 📝 详细操作说明

### 1️⃣ 平台管理

**添加平台：**
- 平台标识：只能包含字母、数字、下划线（如：`wechat`）
- 平台名称：显示在网站上的名称（如：`微信公众号`）

**注意事项：**
- 平台标识添加后不建议修改（会影响关联的账号）
- 删除平台会同时删除该平台下的所有账号

**常用平台示例：**
| 平台标识 | 平台名称 |
|---------|---------|
| wechat | 微信公众号 |
| weibo | 微博 |
| douyin | 抖音 |
| bilibili | B站 |
| xiaohongshu | 小红书 |
| kuaishou | 快手 |

### 2️⃣ 分类管理

**添加分类：**
- 分类标识：只能包含字母、数字、下划线（如：`xiaoji`）
- 分类名称：显示在网站上的名称（如：`校级媒体`）

**注意事项：**
- 分类标识添加后不建议修改
- 删除分类会同时删除该分类下的所有账号

**常用分类示例：**
| 分类标识 | 分类名称 |
|---------|---------|
| xiaoji | 校级媒体 |
| ligong | 理工学院 |
| wenke | 文科学院 |
| shangke | 商科学院 |
| yixue | 医学院 |
| yishu | 艺术学院 |

### 3️⃣ 账号管理

**添加账号：**
1. 选择所属平台（如：微信公众号）
2. 选择所属分类（如：校级媒体）
3. 填写账号信息：
   - **账号名称**（必填）：如 `校团委`
   - **账号简介**（可选）：如 `发布校园活动、青年资讯`
   - **头像 URL**（必填）：图片链接地址
   - **链接 URL**（必填）：账号主页链接

**头像图片要求：**
- 建议尺寸：200x200 像素（正方形）
- 支持格式：PNG、JPG、WEBP
- 必须是完整的 URL（以 `http://` 或 `https://` 开头）

**链接 URL 要求：**
- 必须是完整的 URL
- 必须以 `http://` 或 `https://` 开头
- 建议使用官方链接

**筛选功能：**
- 可按平台筛选
- 可按分类筛选
- 支持组合筛选

### 4️⃣ Excel 导入导出

#### Excel 文件格式说明

**Sheet 1 - 平台配置：**
| 平台标识 | 平台名称 |
|---------|---------|
| wechat | 微信公众号 |
| weibo | 微博 |

**Sheet 2 - 分类配置：**
| 分类标识 | 分类名称 |
|---------|---------|
| xiaoji | 校级媒体 |
| ligong | 理工学院 |

**Sheet 3 - 账号配置：**
| 平台标识 | 分类标识 | 账号名称 | 头像URL | 链接URL | 简介 |
|---------|---------|---------|---------|---------|------|
| wechat | xiaoji | 校团委 | https://... | https://... | 发布校园活动 |

#### 导入注意事项

✅ **必须包含表头行**（第一行）  
✅ **必填列不能为空**：平台标识、分类标识、账号名称、头像URL、链接URL  
✅ **标识格式**：只能包含字母、数字、下划线  
✅ **URL 格式**：必须以 http:// 或 https:// 开头  
✅ **工作表名称**：必须是 `平台配置`、`分类配置`、`账号配置`  

#### 常见错误及解决

❌ **导入失败：找不到工作表**  
→ 确保工作表名称正确（区分中文大小写）

❌ **导入后数据不完整**  
→ 检查是否有空行或格式错误的数据

❌ **账号显示不出来**  
→ 确保平台标识和分类标识已在前两个表中定义

---

## 🔄 完整工作流程示例

### 场景：从零开始配置新媒体平台

**步骤 1：添加平台**
```
1. 打开管理后台
2. 点击【平台管理】
3. 依次添加：
   - wechat / 微信公众号
   - weibo / 微博
   - douyin / 抖音
```

**步骤 2：添加分类**
```
1. 点击【分类管理】
2. 依次添加：
   - xiaoji / 校级媒体
   - ligong / 理工学院
   - wenke / 文科学院
```

**步骤 3：添加账号**
```
1. 点击【账号管理】
2. 添加第一个账号：
   - 平台：微信公众号
   - 分类：校级媒体
   - 名称：校团委
   - 简介：发布校园活动、青年资讯
   - 头像：https://example.com/logo.png
   - 链接：https://example.com/youth
3. 重复添加其他账号...
```

**步骤 4：生成配置**
```
1. 点击【💾 生成配置文件】
2. 下载 config.js
3. 替换项目中的 js/config.js
4. 刷新网站查看效果
```

### 场景：使用 Excel 批量更新

**步骤 1：导出现有数据**
```
1. 点击【📤 导出 Excel】
2. 保存文件到本地
```

**步骤 2：Excel 编辑**
```
1. 打开 Excel 文件
2. 在【账号配置】表中批量添加账号：
   - 复制粘贴已有数据行
   - 修改账号信息
   - 可一次性添加多个账号
```

**步骤 3：导入更新**
```
1. 保存 Excel 文件
2. 点击【📥 导入 Excel】
3. 选择编辑好的文件
4. 系统自动更新
```

**步骤 4：生成配置**
```
1. 点击【💾 生成配置文件】
2. 替换 config.js
3. 完成！
```

---

## ⚠️ 注意事项

### 数据规范

1. **标识符命名规则**
   - 只能使用：字母、数字、下划线
   - 不能使用：中文、空格、特殊符号
   - 示例：✅ `xiaoji` ✅ `school_media` ❌ `校级` ❌ `school media`

2. **URL 链接要求**
   - 必须完整（包含协议）
   - ✅ `https://example.com`
   - ❌ `example.com`
   - ❌ `www.example.com`

3. **图片资源**
   - 建议使用稳定的图床
   - 建议尺寸：200x200px
   - 支持格式：PNG、JPG、WEBP

### 数据安全

1. **备份数据**
   - 修改前先导出 Excel 备份
   - 定期保存配置文件

2. **谨慎删除**
   - 删除平台/分类会级联删除所有关联账号
   - 删除前务必确认

3. **版本管理**
   - 每次生成配置文件都会标注时间
   - 建议保留历史版本

### 浏览器兼容

- ✅ Chrome（推荐）
- ✅ Edge
- ✅ Firefox
- ✅ Safari
- ⚠️ IE11（部分功能可能不支持）

---

## 🆘 常见问题

### Q1: 导出的 Excel 文件在哪里？
**A:** 浏览器默认下载文件夹，文件名格式：`新媒体平台配置_2025-10-15.xlsx`

### Q2: 如何修改已有账号的分类？
**A:** 点击账号的【编辑】按钮，重新选择平台和分类，保存即可。

### Q3: 生成的 config.js 如何使用？
**A:** 下载后，替换项目中的 `js/config.js` 文件，然后刷新网站。

### Q4: Excel 导入失败怎么办？
**A:** 
- 检查工作表名称是否正确
- 检查数据格式是否符合要求
- 检查是否有必填项为空

### Q5: 可以同时打开多个管理后台吗？
**A:** 可以，但建议只在一个窗口中编辑，避免数据冲突。

### Q6: 如何恢复到之前的配置？
**A:** 
- 方法1：导入之前备份的 Excel 文件
- 方法2：使用之前保存的 config.js 文件

### Q7: 能否添加自定义字段？
**A:** 当前版本不支持，如有需求可联系开发者定制。

---

## 💡 最佳实践

### 1. 数据管理建议

✅ **定期备份**
- 每周导出一次 Excel 备份
- 重要修改前先备份

✅ **命名规范**
- 使用有意义的英文标识
- 保持命名风格一致
- 避免使用拼音缩写

✅ **图片管理**
- 使用稳定的图床服务
- 统一图片尺寸和格式
- 定期检查图片链接有效性

### 2. 协作建议

📌 **单人维护**
- 指定专人负责数据更新
- 制定更新流程和规范

📌 **团队协作**
- 使用 Excel 离线编辑
- 统一收集后集中导入
- 避免多人同时编辑

### 3. 效率提升

⚡ **快速添加账号**
1. 先在 Excel 中准备好数据
2. 使用导入功能批量添加
3. 比逐个添加快 10 倍

⚡ **批量修改**
1. 导出 Excel
2. 使用查找替换功能
3. 快速修改相似内容

---

## 📞 技术支持

如遇到问题，请：

1. **查看本文档** - 大部分问题都有解答
2. **检查数据格式** - 确保符合规范
3. **查看浏览器控制台** - 可能有错误提示
4. **联系技术支持** - 提供详细的错误截图

---

## 🎉 总结

恭喜您掌握了管理后台的使用！

记住这三个关键步骤：
1. **📝 编辑数据** - 使用界面或 Excel
2. **💾 生成配置** - 点击生成按钮
3. **🔄 替换文件** - 更新 config.js

现在开始管理您的新媒体平台吧！

---

*最后更新：2025-10-15*

